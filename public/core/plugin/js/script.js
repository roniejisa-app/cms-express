const r={endpoint:"",headers:{},body:{},params:{},options:{},setHeaders:(e,n)=>{r.headers[e]=n},setBody:(e,n)=>{r.body[e]=n},buildData:(e,n)=>{if(n==="json")return JSON.stringify(e);if(n==="formData"){const t=new FormData;for(const[a,s]of Object.entries(e))s instanceof FileList?Array.from(s).forEach(o=>{t.append(a,o)}):t.append(a,s);return t}else{let t=[];for(const[a,s]of Object.entries(e))t.push(`${a}=${s}`);return t=t.join("&"),t}},setParam:(e,n)=>{r.params[e]=n},send:async(e,n,t=null,a="json")=>{let s="";const o={headers:r.headers};a==="json"?o.headers["Content-Type"]="application/json":a==="form"?o.headers["Content-Type"]="application/x-www-form-urlencoded":a==="formData"&&delete o.headers["Content-Type"],t&&(e==="GET"||a==="form"||a==="formData"?o.body=r.buildData(t,a):o.body=JSON.stringify(t)),Object.entries(r.params).length&&(s+="?"+r.buildData(r.params)),o.method=e;try{const i=await fetch(`${r.getEndpoint()}${n}${s}`,o),c=await i.json();return{error:!1,response:i,data:c}}catch(i){return{error:{status:100,message:i.message}}}},getEndpoint:()=>r.endpoint,setEndpoint:e=>{r.endpoint=e},get:async(e,n=null,t="json")=>r.send("GET",e,n,t),post:async(e,n,t="json")=>r.send("POST",e,n,t),patch:async(e,n,t="json")=>r.send("PATCH",e,n,t)};window.addEventListener("DOMContentLoaded",function(){document!=null&&document.querySelector('meta[name="csrf-token"]')&&r.setHeaders("X-CSRF-TOKEN",document.querySelector('meta[name="csrf-token"]').getAttribute("content"))});(()=>{const e=document.querySelectorAll(".btn-install");for(const n of e)n.addEventListener("click",t=>{t.preventDefault();const a=n.getAttribute("data-name");n.innerText="Đang cài đặt...",r.post("/admin/plugin/install",{name:a}).then(s=>{n.innerText="Đã cài đặt"}).catch(s=>{n.innerText="Cài đặt"})})})();
