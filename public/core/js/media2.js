import{n as g,r as k,f as De,u as Be}from"./config.js";let Oe=document.querySelector("aside"),z=Oe.querySelector(".folder-list ul"),Ne=document.querySelector(".media-main"),F=Ne.querySelector(".files"),x=F.querySelector(".list-item"),Fe=Ne.querySelector(".folders"),W=Fe.querySelector(".list-item"),Z=document.querySelector(".media-info");const j={itemFolder:e=>`<a href="${window.location.pathname}/${e.id}" class="item folder" data-file='${JSON.stringify(e)}'>
                    <img src="/images/admin/folder.svg" alt="${e.filename}">
                    <div class="item-info">
                        <h3>${e.filename}</h3>
                    </div>
                </a>`,itemFolderAside:e=>`<li data-id="${e.id}">
          <a href="${window.location.pathname}/${e.id}">
            <img src="/images/admin/folder.svg" alt="Folder">
            <span>${e.filename}</span>
          </a>
        </li>`,itemFile:e=>{let t=`<label class="item file" data-file='${JSON.stringify(e)}'>
                    <input type="checkbox" name="id" value="${e.id}" hidden>`;return["png","jpeg","jpg","webp","tiff","svg","bmp"].includes(e.extension.toLowerCase())?t+=`<img src="/${e.path_absolute}" alt="${e.filename}">`:["docx","pptx","xlsx","pdf","mp4"].includes(e.extension.toLowerCase())?t+=`<img src="/images/admin/${extension.toLowerCase()}.svg" alt="${e.filename}">`:t+=`<img src="/images/admin/file.svg" alt="${e.filename}">`,t+=`<div class="file-body">
                        <h3>${e.filename}</h3>
                        <ul class="action">`,e.delete_at!==null?t+=`<li>
                                    <button class="restore">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                                            <path
                                                d="M142.9 142.9c62.2-62.2 162.7-62.5 225.3-1L327 183c-6.9 6.9-8.9 17.2-5.2 26.2s12.5 14.8 22.2 14.8H463.5c0 0 0 0 0 0H472c13.3 0 24-10.7 24-24V72c0-9.7-5.8-18.5-14.8-22.2s-19.3-1.7-26.2 5.2L413.4 96.6c-87.6-86.5-228.7-86.2-315.8 1C73.2 122 55.6 150.7 44.8 181.4c-5.9 16.7 2.9 34.9 19.5 40.8s34.9-2.9 40.8-19.5c7.7-21.8 20.2-42.3 37.8-59.8zM16 312v7.6 .7V440c0 9.7 5.8 18.5 14.8 22.2s19.3 1.7 26.2-5.2l41.6-41.6c87.6 86.5 228.7 86.2 315.8-1c24.4-24.4 42.1-53.1 52.9-83.7c5.9-16.7-2.9-34.9-19.5-40.8s-34.9 2.9-40.8 19.5c-7.7 21.8-20.2 42.3-37.8 59.8c-62.2 62.2-162.7 62.5-225.3 1L185 329c6.9-6.9 8.9-17.2 5.2-26.2s-12.5-14.8-22.2-14.8H48.4h-.7H40c-13.3 0-24 10.7-24 24z" />
                                        </svg>
                                    </button>
                                </li>
                                <li>
                                    <button class="delete-force">
                                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M135.2 17.7L128 32H32C14.3 32 0 46.3 0 64S14.3 96 32 96H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H320l-7.2-14.3C307.4 6.8 296.3 0 284.2 0H163.8c-12.1 0-23.2 6.8-28.6 17.7zM416 128H32L53.2 467c1.6 25.3 22.6 45 47.9 45H346.9c25.3 0 46.3-19.7 47.9-45L416 128z"/></svg>
                                    </button>
                                </li>`:t+=`<li><button class="edit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M410.3 231l11.3-11.3-33.9-33.9-62.1-62.1L291.7 89.8l-11.3 11.3-22.6 22.6L58.6 322.9c-10.4 10.4-18 23.3-22.2 37.4L1 480.7c-2.5 8.4-.2 17.5 6.1 23.7s15.3 8.5 23.7 6.1l120.3-35.4c14.1-4.2 27-11.8 37.4-22.2L387.7 253.7 410.3 231zM160 399.4l-9.1 22.7c-4 3.1-8.5 5.4-13.3 6.9L59.4 452l23-78.1c1.4-4.9 3.8-9.4 6.9-13.3l22.7-9.1v32c0 8.8 7.2 16 16 16h32zM362.7 18.7L348.3 33.2 325.7 55.8 314.3 67.1l33.9 33.9 62.1 62.1 33.9 33.9 11.3-11.3 22.6-22.6 14.5-14.5c25-25 25-65.5 0-90.5L453.3 18.7c-25-25-65.5-25-90.5 0zm-47.4 168l-144 144c-6.2 6.2-16.4 6.2-22.6 0s-6.2-16.4 0-22.6l144-144c6.2-6.2 16.4-6.2 22.6 0s6.2 16.4 0 22.6z"/></svg></button></li>
                            <li><button class="delete"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M135.2 17.7L128 32H32C14.3 32 0 46.3 0 64S14.3 96 32 96H416c17.7 0 32-14.3 32-32s-14.3-32-32-32H320l-7.2-14.3C307.4 6.8 296.3 0 284.2 0H163.8c-12.1 0-23.2 6.8-28.6 17.7zM416 128H32L53.2 467c1.6 25.3 22.6 45 47.9 45H346.9c25.3 0 46.3-19.7 47.9-45L416 128z"/></svg></button></li>`,t+=`</ul>
                    </div>
                </label>`,t},listItemFolderAside:(e,t=null)=>`<ul>${e.map(n=>`<li>
                <a href="/admin/medias/${t!=null?t+"/":""}${n.id}">
                    ${n.medias&&n.medias?`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512">
                        <path d="M137.4 374.6c12.5 12.5 32.8 12.5 45.3 0l128-128c9.2-9.2 11.9-22.9 6.9-34.9s-16.6-19.8-29.6-19.8L32 192c-12.9 0-24.6 7.8-29.6 19.8s-2.2 25.7 6.9 34.9l128 128z" />
                        </svg>`:""}
                    <img src="/images/admin/folder.svg" alt="${n.filename}">
                    <span>${n.filename}</span>
                </a>
            </li>`).join("")}</ul>`,editFile:(e,t,i,n,s,o)=>`
                <h1>Sửa thông tin</h1>
                ${["png","jpeg","webp","tiff","bmp","jpg"].includes(e)?`
                <div class="image">
                    <img src="/${t}" alt="" />
                </div>
                `:""}
                <form action="/admin/medias/edit-file/${o}">
                <input type="text" name="changeImage" value="0" hidden/>
                <label>
                    <span>Tiêu đề</span>
                    <input type="text" name="filename" value="${i}" placeholder="Nhập tiêu đề file"/>
                </label>
                <label>
                    <span>URL</span>
                    <input type="text" name="path_absolute" value="${window.location.origin+"/"+t}" placeholder="Nhập đường dẫn"/>
                </label>
                <label>
                    <span>Ghi chú</span>
                    <textarea name="note" placeholder="Nhập ghi chú"/>${n??""}</textarea>
                </label>
                <label>
                    <span>Mô tả</span>
                    <textarea name="description" cols="30" placeholder="Nhập mô tả">${s??""}</textarea>
                </label>
            </form>`,templateFolder:e=>{let t="";return t+="<ul>",e.delete_at?t+=`<li>
                <button class="restore">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M142.9 142.9c62.2-62.2 162.7-62.5 225.3-1L327 183c-6.9 6.9-8.9 17.2-5.2 26.2s12.5 14.8 22.2 14.8H463.5c0 0 0 0 0 0H472c13.3 0 24-10.7 24-24V72c0-9.7-5.8-18.5-14.8-22.2s-19.3-1.7-26.2 5.2L413.4 96.6c-87.6-86.5-228.7-86.2-315.8 1C73.2 122 55.6 150.7 44.8 181.4c-5.9 16.7 2.9 34.9 19.5 40.8s34.9-2.9 40.8-19.5c7.7-21.8 20.2-42.3 37.8-59.8zM16 312v7.6 .7V440c0 9.7 5.8 18.5 14.8 22.2s19.3 1.7 26.2-5.2l41.6-41.6c87.6 86.5 228.7 86.2 315.8-1c24.4-24.4 42.1-53.1 52.9-83.7c5.9-16.7-2.9-34.9-19.5-40.8s-34.9 2.9-40.8 19.5c-7.7 21.8-20.2 42.3-37.8 59.8c-62.2 62.2-162.7 62.5-225.3 1L185 329c6.9-6.9 8.9-17.2 5.2-26.2s-12.5-14.8-22.2-14.8H48.4h-.7H40c-13.3 0-24 10.7-24 24z"/></svg>
                    Phục hồi
                </button>
            </li>
            <li>
                <button class="delete-force">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                        <path
                            d="M135.2 17.7C140.6 6.8 151.7 0 163.8 0H284.2c12.1 0 23.2 6.8 28.6 17.7L320 32h96c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 96 0 81.7 0 64S14.3 32 32 32h96l7.2-14.3zM32 128H416V448c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V128zm96 64c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16z" />
                    </svg>
                    Xóa
                </button>
            </li>`:t+=`<li>
                <button class="edit">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M441 58.9L453.1 71c9.4 9.4 9.4 24.6 0 33.9L424 134.1 377.9 88 407 58.9c9.4-9.4 24.6-9.4 33.9 0zM209.8 256.2L344 121.9 390.1 168 255.8 302.2c-2.9 2.9-6.5 5-10.4 6.1l-58.5 16.7 16.7-58.5c1.1-3.9 3.2-7.5 6.1-10.4zM373.1 25L175.8 222.2c-8.7 8.7-15 19.4-18.3 31.1l-28.6 100c-2.4 8.4-.1 17.4 6.1 23.6s15.2 8.5 23.6 6.1l100-28.6c11.8-3.4 22.5-9.7 31.1-18.3L487 138.9c28.1-28.1 28.1-73.7 0-101.8L474.9 25C446.8-3.1 401.2-3.1 373.1 25zM88 64C39.4 64 0 103.4 0 152V424c0 48.6 39.4 88 88 88H360c48.6 0 88-39.4 88-88V312c0-13.3-10.7-24-24-24s-24 10.7-24 24V424c0 22.1-17.9 40-40 40H88c-22.1 0-40-17.9-40-40V152c0-22.1 17.9-40 40-40H200c13.3 0 24-10.7 24-24s-10.7-24-24-24H88z"/></svg>
                    Chỉnh sửa
                </button>
            </li>
            <li>
                <button class="delete">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                        <path
                            d="M135.2 17.7C140.6 6.8 151.7 0 163.8 0H284.2c12.1 0 23.2 6.8 28.6 17.7L320 32h96c17.7 0 32 14.3 32 32s-14.3 32-32 32H32C14.3 96 0 81.7 0 64S14.3 32 32 32h96l7.2-14.3zM32 128H416V448c0 35.3-28.7 64-64 64H96c-35.3 0-64-28.7-64-64V128zm96 64c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16V432c0 8.8 7.2 16 16 16s16-7.2 16-16V208c0-8.8-7.2-16-16-16z" />
                    </svg>
                    Thùng rác
                </button>
            </li>`,t+="</ul>",t}};new Event("update-process-event");const S={headers:{"Content-Type":"application/json"},eventUploads:{},body:{},params:{},endpoint:"",type:"",send:function(e,t,i={}){return new Promise((n,s)=>{const o=new XMLHttpRequest;for(const[u,w]of Object.entries(this.eventUploads))o.upload.addEventListener(u,w);this.setBody(i),this.type===""?this.setHeader("Content-Type","application/json"):this.type==="form"?this.setHeader("Content-Type","application/x-www-form-urlencoded"):this.type==="formData"&&this.setHeader("Content-Type","multipart/form-data"),o.addEventListener("progress",function(u){let w=+(u.loaded/u.total*100).toFixed(2),f=document.body.querySelector(".progress-upload");document.body.querySelector(".progress-upload")||(f=document.createElement("div"),f.className="progress-upload",f.innerHTML=`<span></span>
                                        <svg width="100" height="100" viewBox="0 0 100 100" class="circular-progress">
                                            <defs>
                                            <linearGradient id="GradientColor">
                                                <stop offset="0%" stop-color="yellow"></stop>
                                                <stop offset="50%" stop-color="red"></stop>
                                                <stop offset="100%" stop-color="#80afe7"></stop>
                                            </linearGradient>
                                            </defs>
                                            <circle class="bg"></circle>
                                            <circle class="fg"></circle>
                                        </svg>`,document.body.append(f));const b=f.querySelector("span");f.querySelector(".circular-progress").style.setProperty("--progress",w),b.innerText=`${w}%`,w===100&&f.animate([{opacity:1},{opacity:0}],{duration:1e3,easing:"ease-in-out"}).finished.then(function(){f.remove()})}),o.responseType="json",o.onreadystatechange=()=>{o.readyState===XMLHttpRequest.DONE&&o.status===200&&n(o.response)},o.addEventListener("process",u=>{dispatchEvent(event)});let a=this.getParams(),r=this.endpoint+t+(a?"?"+a:""),m=this.buildBody();if(o.open(e,r),Object.keys(this.headers).length)for(let u of Object.keys(this.headers))this.type==="formData"&&u==="Content-Type"||o.setRequestHeader(u,this.headers[u]);o.send(m)})},setEventUpload:function(e,t){this.eventUploads[e]=t},setType:function(e){this.type=e},buildBody:function(){if(this.type==="formData"||this.type==="formExpress"){const e=new FormData;for(let t of Object.keys(this.body))if(Array.isArray(this.body[t]))for(const i of this.body[t])e.append(t,i);else e.append(t,S.body[t]);return e}else return JSON.stringify(this.body)},setBody:function(e){this.body=e},getParams:function(){return Object.entries(this.params).map(([e,t])=>`${e}=${t}`).join("&")},setParams:function(e,t){this.params[e]=t},setHeader:function(e,t){this.headers[e]=t},setEndpoint:function(e){this.endpoint=e},get:async(e,t={})=>S.send("get",e,t),post:async(e,t={})=>S.send("post",e,t),patch:async(e,t={})=>S.send("PATCH",e,t)},se=new Event("cut-canvas-image");let T=0,V=1,X={},me,fe,v,O,U,xe,ie,H,$,q,M,A;function Re(e,t,i,n,s){e.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M0 32v448h448V32H0zm358.4 179.2h-89.6v89.6h-89.6v89.6H89.6V121.6h268.8v89.6z"/></svg><p>Lật ảnh</p>',t.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M48.5 224H40c-13.3 0-24-10.7-24-24V72c0-9.7 5.8-18.5 14.8-22.2s19.3-1.7 26.2 5.2L98.6 96.6c87.6-86.5 228.7-86.2 315.8 1c87.5 87.5 87.5 229.3 0 316.8s-229.3 87.5-316.8 0c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0c62.5 62.5 163.8 62.5 226.3 0s62.5-163.8 0-226.3c-62.2-62.2-162.7-62.5-225.3-1L185 183c6.9 6.9 8.9 17.2 5.2 26.2s-12.5 14.8-22.2 14.8H48.5z"/></svg>
    <p>Xoay Trái</p>`,i.innerHTML=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M463.5 224H472c13.3 0 24-10.7 24-24V72c0-9.7-5.8-18.5-14.8-22.2s-19.3-1.7-26.2 5.2L413.4 96.6c-87.6-86.5-228.7-86.2-315.8 1c-87.5 87.5-87.5 229.3 0 316.8s229.3 87.5 316.8 0c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0c-62.5 62.5-163.8 62.5-226.3 0s-62.5-163.8 0-226.3c62.2-62.2 162.7-62.5 225.3-1L327 183c-6.9 6.9-8.9 17.2-5.2 26.2s12.5 14.8 22.2 14.8H463.5z"/></svg>
    <span>Xoay phải</span>`,e.onclick=()=>{V=1,T=0,V===1?V=-1:V=1,ue()},t.onclick=()=>{V=1,T=0,T-=90,ue()},i.onclick=()=>{V=1,T=0,T+=90,T===360&&(T=0),ue()},n&&(n.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M142.9 142.9c62.2-62.2 162.7-62.5 225.3-1L327 183c-6.9 6.9-8.9 17.2-5.2 26.2s12.5 14.8 22.2 14.8H463.5c0 0 0 0 0 0H472c13.3 0 24-10.7 24-24V72c0-9.7-5.8-18.5-14.8-22.2s-19.3-1.7-26.2 5.2L413.4 96.6c-87.6-86.5-228.7-86.2-315.8 1C73.2 122 55.6 150.7 44.8 181.4c-5.9 16.7 2.9 34.9 19.5 40.8s34.9-2.9 40.8-19.5c7.7-21.8 20.2-42.3 37.8-59.8zM16 312v7.6 .7V440c0 9.7 5.8 18.5 14.8 22.2s19.3 1.7 26.2-5.2l41.6-41.6c87.6 86.5 228.7 86.2 315.8-1c24.4-24.4 42.1-53.1 52.9-83.7c5.9-16.7-2.9-34.9-19.5-40.8s-34.9 2.9-40.8 19.5c-7.7 21.8-20.2 42.3-37.8 59.8c-62.2 62.2-162.7 62.5-225.3 1L185 329c6.9-6.9 8.9-17.2 5.2-26.2s-12.5-14.8-22.2-14.8H48.4h-.7H40c-13.3 0-24 10.7-24 24z"/></svg><p>Khôi phục</p>',n.addEventListener("click",async function(){if(confirm("Bạn có muốn khôi phục lại ảnh gốc không?"))try{const o=await S.patch(`/admin/medias/edit-file/${s}`,{changeImage:"original"});if(o.status===200){g.success(o.message);let a=Array.from(x.children).find(r=>JSON.parse(r.dataset.file).id===o.data.id);a.insertAdjacentHTML("beforebegin",j.itemFile(o.data)),a.remove(),dispatchEvent(le),document.querySelector('.edit-file .edit-info button[type="button"]').click()}else g.error(o.message)}catch(o){g.error(o.message)}}))}function Ve(e,t,i,n){X={imageContainer:e,imgEditEl:t,imgEl:i,inputChangeImage:n},e.style.position="relative",e.style.fontSize=0,t.style.pointerEvents="none",e.style.userSelect="none";let s=!1;v=document.createElement("div");const o=document.createElement("div"),a=document.createElement("div"),r=document.createElement("div"),m=document.createElement("div");Xe(o,a,r,m,v,t),v.append(o,a,r,m),e.append(v),X.divEl=v,X.croppedCanvasContainer=v,o.addEventListener("mousedown",function(){s=!0,H=v.getBoundingClientRect(),xe=H.left+H.width,ie=H.top+H.height,O=e.getBoundingClientRect().left,U=e.getBoundingClientRect().top,document.addEventListener("mousemove",w)}),a.addEventListener("mousedown",function(){s=!0,H=v.getBoundingClientRect(),ie=H.top+H.height,O=e.getBoundingClientRect().left,U=e.getBoundingClientRect().top,document.addEventListener("mousemove",f)}),r.addEventListener("mousedown",function(l){s=!0,H=v.getBoundingClientRect(),O=e.getBoundingClientRect().left,U=e.getBoundingClientRect().top,document.addEventListener("mousemove",b)}),m.addEventListener("mousedown",function(l){s=!0,H=v.getBoundingClientRect(),document.addEventListener("mousemove",p)}),document.addEventListener("mouseup",()=>{document.removeEventListener("mousemove",w),document.removeEventListener("mousemove",f),document.removeEventListener("mousemove",b),document.removeEventListener("mousemove",p),document.removeEventListener("mousemove",u),s&&$e(),s=!1}),v.addEventListener("mousedown",l=>{l.target===v&&(me=v.style.left,fe=v.style.top,O=l.clientX,U=l.clientY,document.addEventListener("mousemove",u))});function u(l){const c=v.parentElement.getBoundingClientRect(),d=v.getBoundingClientRect(),h=c.width-d.width,y=c.height-d.height;let E,L;const Q=Math.abs(l.clientX-O),I=Math.abs(l.clientY-U);E=+me.replace("px",""),L=+fe.replace("px",""),E=E+(l.clientX>=O?Q:-Q),L=L+(l.clientY>=U?I:-I),E>h?E=h:E<0&&(E=0),L>y?L=y:L<0&&(L=0),v.style.left=E+"px",v.style.top=L+"px",A=E,M=L,(v.style.left!==me||v.style.top!==fe)&&(s=!0)}function w(l){const c=l.clientX,d=l.clientY;A=c-O,M=d-U,$=xe-c,q=ie-d,te()}function f(l){const c=l.clientX,d=l.clientY;M=d-U,A=H.left-O,$=c-H.left,q=ie-d,te()}function b(l){const c=l.clientX,d=l.clientY;M=v.offsetTop,A=c-O,$=H.width+H.left-c,q=d-H.top,te()}function p(l){const c=l.clientX,d=l.clientY;M=v.offsetTop,A=v.offsetLeft,$=c-H.left,q=d-H.top,te()}}function te(e=!1){if(e){const i=M;M=A,A=i}q>=20&&M>=0&&(v.style.top=M+"px"),$>=20&&A>=0&&(v.style.left=A+"px");const t=v.parentElement.getBoundingClientRect();M+q>t.height&&(q=t.height-M),A+$>t.width&&($=t.width-A),$>=20&&A>=0&&(v.style.width=$+"px"),q>=20&&M>=0&&(v.style.height=q+"px")}function Xe(e,t,i,n,s,o){s.style.position="absolute",s.style.top=0,s.style.zIndex=3,s.style.left=0,s.style.background="rgba(0,0,0,0.1)",s.style.width=`${o.offsetWidth}px`,s.style.height=`${o.offsetHeight}px`,s.style.cursor="move",$=o.offsetWidth,q=o.offsetHeight,A=0,M=0,s.style.border="1px solid white",[e,t,i,n].forEach(a=>{a.style.width="10px",a.style.height="10px",a.style.borderRadius="50%",a.style.position="absolute",a.style.border="1px solid white",a.style.background="black",a.style.zIndex=3}),e.style.cursor="nwse-resize",t.style.cursor="sw-resize",i.style.cursor="sw-resize",n.style.cursor="nwse-resize",e.style.transform="translate(-50%,-50%)",t.style.transform="translate(50%,-50%)",t.style.right=0,t.style.top=0,i.style.transform="translate(-50%, 50%)",i.style.bottom=0,i.style.left=0,n.style.transform="translate(50%, 50%)",n.style.bottom=0,n.style.right=0}function $e(){if(X.croppedCanvasContainer&&X.imgEl&&X.imgEditEl){const{croppedCanvasContainer:e,imgEl:t,imgEditEl:i}=X;se.croppedCanvasContainer=e,se.imgEl=t,se.imgEditEl=i,window.dispatchEvent(se)}}function Pe(){window.addEventListener("cut-canvas-image",function(e){const{croppedCanvasContainer:t,imgEl:i,imgEditEl:n}=e,{inputChangeImage:s}=X,o=n.offsetWidth,a=n.offsetHeight,r=n.naturalWidth,m=n.naturalHeight,u=r/o,w=m/a,f=document.createElement("canvas");let b=f.getContext("2d");const p=new Image;p.src=n.src,p.onload=()=>{const l=document.createElement("div");f.width=t.offsetWidth*u,f.height=t.offsetHeight*w,l.append(p),l.append(f),l.style.position="relative",l.style.width=p.naturalWidth+"px",l.style.height=p.naturalHeight+"px",f.style.position="absolute",f.style.left=+t.style.left.replace("px","")*u+"px",f.style.top=+t.style.top.replace("px","")*w+"px";let c=+f.style.left.replace("px",""),d=+f.style.top.replace("px",""),h=0,y=0;b.drawImage(p,c,d,f.width,f.height,h,y,f.width,f.height),s.value="new",i.src=f.toDataURL()}})}function ue(){const{imgEditEl:e,imgEl:t}=X,i=document.createElement("canvas");let n=i.getContext("2d");const s=new Image;s.src=e.src,s.onload=()=>{Math.abs(T)===90?(i.width=s.naturalHeight,i.height=s.naturalWidth):(i.width=s.naturalWidth,i.height=s.naturalHeight);let o=0;T!==0&&(n.rotate(T*Math.PI/180),T===90?n.translate(0,-i.width):T===-90&&n.translate(-i.height,0)),V===-1&&(n.scale(V,1),o=+(i.width*V)),n.drawImage(s,o,0),e.src=i.toDataURL(),e.onload=()=>{t.src=e.src,te(Math.abs(T)===90),$e()}}}let ge=ze();const qe=new Event("has-new-folder"),Ue=new Event("add-all-action"),Ye=new Event("refresh-event-folder");function ze(){return z&&z.querySelectorAll("a")}function Le(){Fe.querySelectorAll(".list-item .item").forEach(t=>{t.addEventListener("contextmenu",function(i){i.preventDefault();let n=document.querySelector(".menu-folder");n&&n.remove();const s=i.pageX,o=i.pageY;n=document.createElement("div"),n.className="menu-folder";const a=JSON.parse(t.dataset.file);n.dataset.file=t.dataset.file,n.innerHTML=j.templateFolder(a),document.body.append(n),n.style.left=s+"px",n.style.top=o+"px",n.querySelectorAll("ul li button").forEach(m=>{m.addEventListener("click",async function(u){const w=a.id;switch(m.className){case"edit":const f=document.createElement("form");f.classList.add("form-add-folder");const b=document.createElement("div");b.classList.add("form-container");const p=document.createElement("input");p.placeholder="Nhập tên thư mục...",p.value=a.filename;const l=document.createElement("button");b.append(p,l),f.append(b),l.innerText="Sửa thư mục",f.onsubmit=async c=>{l.setAttribute("disabled",!0),c.preventDefault(),k.setEndpoint("");const d=await k.post(`/admin/medias/edit/folder/${a.id}`,{folderName:p.value});d.data.status===200?(g.success(d.data.message),a.filename=d.data.folderName,t.dataset.file=JSON.stringify(a),t.querySelector("h3").innerText=d.data.folderName,z.querySelector(`[data-id="${a.id}"] span`).innerText=d.data.folderName):g.error(d.data.message),f.remove()},f.onclick=c=>{c.target===f&&f.remove()},document.body.append(f);break;case"delete":if(confirm("Chuyển mục này vào thùng rác!")){k.setEndpoint("");const c=await k.post(`/admin/medias/delete/${a.id}`);if(c.data.status===200){g.success(c.data.message),t.remove(),n&&n.remove(),W.children.length===0&&(W.innerHTML="<p>Chưa có thư mục nào!</p>");const d=Array.from(z.children).find(h=>+h.dataset.id==+a.id);d&&d.closest("li").remove(),z.children.length===0&&(z.innerHTML="<ul><p>Chưa có thư mục nào!</p></ul>")}else g.error(c.data.message)}break;case"restore":try{const c=await k.post("/admin/medias/restore-all",{ids:[w],restore:!0});c.data.status===200?(g.success(c.data.message),t.remove(),n&&n.remove(),W.children.length===0&&(W.innerHTML="<p>Chưa có thư mục nào!</p>")):g.error(c.data.message)}catch{g.error("Thử lại sau!")}break;case"delete-force":if(confirm("Bạn có chắc muốn xóa tệp tin này? Chúng sẽ không còn xuất hiện trên blog của bạn, bao gồm bài viết, trang, và widget. Hành động này không thể phục hồi.")){const c=await S.post("/admin/medias/delete-force",{ids:[a.id]});c.status===200?(g.success(c.message),t.remove(),n&&n.remove(),W.children.length===0&&(x.innerHTML="<p>Không có tệp tin nào!</p>")):g.error(c.message)}break}})}),n.addEventListener("mousedown",function(m){m.stopPropagation()})})}),document.addEventListener("mousedown",function(t){let i=document.querySelector(".menu-folder");i&&i.remove()})}function Ce(){if(!ge)return!1;for(const t of ge)t.onclick=e;async function e(t){if((t.target.nodeName==="svg"||t.target.nodeName==="path")&&(t.preventDefault(),!this.nextElementSibling)){const i=this.getAttribute("href").replace("/admin/medias/",""),n=await k.get("/admin/medias/folder/"+i);this.insertAdjacentHTML("afterend",j.listItemFolderAside(n.data.folders,n.data.id)),window.dispatchEvent(qe)}}}function ve(){for(const e of x.children){const{id:t,customs:i,filename:n,description:s,note:o,path_absolute:a,extension:r}=JSON.parse(e.dataset.file),m=JSON.parse(i),u=e.querySelector(".delete"),w=e.querySelector(".edit"),f=e.querySelector(".restore"),b=e.querySelector(".delete-force");e.addEventListener("mouseover",function(){this.classList.add("show")}),e.addEventListener("mouseleave",function(){this.classList.remove("show")}),u&&(u.onclick=async()=>{if(confirm("Chuyển mục này vào thùng rác!"))try{k.setEndpoint("");const p=await k.post(`/admin/medias/delete/${t}`);p.data.status===200?(g.success(p.data.message),e.remove()):g.error(p.data.message),x.children.length===0&&(x.innerHTML="<p>Không có tệp tin nào!</p>")}catch{g.error("Thử lại sau!")}}),w&&(w.onclick=()=>{let p=document.querySelector(".edit-file");document.querySelector(".edit-file")&&document.querySelector(".edit-file").remove(),p=document.createElement("div");const l=document.createElement("div");p.className="edit-file",l.className="edit-container",p.append(l);let c,d;if(["png","jpeg","webp","tiff","bmp","jpg"].includes(r)){const I=document.createElement("div"),P=document.createElement("div"),ne=document.createElement("div"),we=document.createElement("button"),be=document.createElement("button"),Ee=document.createElement("button");ne.className="toolbar",ne.append(be,we,Ee);let de;m.pathAbsoluteOriginal&&(de=document.createElement("button"),ne.append(de)),Re(we,be,Ee,de,t),P.className="edit-image-container",c=document.createElement("div"),c.className="image-container",d=document.createElement("img"),d.src=`/${a}`,c.append(d),P.append(c),I.append(P,ne),I.className="edit-image",l.append(I)}const h=document.createElement("div");h.className="edit-info",l.appendChild(h),document.body.append(p),document.body.style.height="100vh",document.body.style.overflow="hidden",h.innerHTML=j.editFile(r,a,n,o,s,t);const y=h.querySelector("form"),E=h.querySelector(".image img"),L=y.querySelector('input[name="changeImage"]');E&&(d.onload=()=>{Ve(c,d,E,L)}),Je(y,h),y.insertAdjacentHTML("beforeend",`<div class="action">
                        <button class="btn btn-reset" type="button">Đóng</button>
                        <button class="btn btn-submit" type="submit">Lưu</button>
                    </div>`),l.querySelector(".btn-reset").addEventListener("click",function(I){document.body.style.removeProperty("height"),document.body.style.removeProperty("overflow"),p.remove()})}),f&&(f.onclick=async()=>{if(confirm("Bạn muốn khôi phục tệp tin này!")){const p=await S.post("/admin/medias/restore-all",{ids:[t]});p.status===200?(g.success(p.message),e.remove(),x.children.length===0&&(x.innerHTML="<p>Không có tệp tin nào!</p>")):g.error(p.message)}}),b&&(b.onclick=async()=>{if(confirm("Bạn có chắc muốn xóa tệp tin này? Chúng sẽ không còn xuất hiện trên blog của bạn, bao gồm bài viết, trang, và widget. Hành động này không thể phục hồi.")){const p=await S.post("/admin/medias/delete-force",{ids:[t]});p.status===200?(g.success(p.message),e.remove(),x.children.length===0&&(x.innerHTML="<p>Không có tệp tin nào!</p>")):g.error(p.message)}})}}function Je(e,t){e.addEventListener("submit",async function(i){i.preventDefault();const n=Object.fromEntries([...new FormData(i.target)]);if(n.changeImage==="new"){const o=t.querySelector(".image img");n.base64Image=o.src}const s=window.location.pathname.replace("/admin/medias","");n.media_id=s;try{const o=await S.patch(e.getAttribute("action"),n);if(o.status===200){g.success(o.message);let a=Array.from(x.children).find(r=>JSON.parse(r.dataset.file).id===o.data.id);a.insertAdjacentHTML("beforebegin",j.itemFile(o.data)),a.remove(),dispatchEvent(le),e.querySelector('button[type="button"]').click()}else g.error(o.message)}catch(o){g.error(o.message)}})}function Ke(){Ce(),ve(),Le(),window.addEventListener("add-all-action",ve),window.addEventListener("has-new-folder",()=>{ge=ze(),Ce()}),window.addEventListener("refresh-event-folder",Le)}let _=x.querySelectorAll(".item"),We=new Event("show-info-file"),C,ee,Y,J,pe,he,G,B,ae,ye=!1;function He(e){if(e.preventDefault(),!e.target.closest(".item")){ye=!0,ae=D(),C=document.createElement("canvas"),document.body.append(C),ee=C.getContext("2d");const t=F.getBoundingClientRect();Y=e.pageX-t.left-window.pageXOffset,J=e.pageY-t.top-window.pageYOffset,F.style.position="relative",C.style.position="absolute",C.style.zIndex="9999",C.width=F.clientWidth,C.height=F.clientHeight,C.style.left=0,C.style.top=0,F.append(C),B=document.createElement("div"),B.style.position="absolute",B.style.zIndex="1000",F.append(B)}}function Se(e){if(ye){let t,i;e.target===C&&(t=e.offsetX-Y,i=e.offsetY-J,ee.clearRect(0,0,C.width,C.height),ee.beginPath(),ee.rect(Y,J,t,i),ee.fillStyle="#80afe799",ee.fill(),pe=e.offsetX,he=e.offsetY,e.offsetX>=Y&&e.offsetY>=J?G={x:Y,y:J}:e.offsetX>=Y&&e.offsetY<=J?G={x:Y,y:he}:e.offsetX<=Y&&e.offsetX&&e.offsetY>=J?G={x:pe,y:J}:G={x:pe,y:he},B.style.width=Math.abs(t)+"px",B.style.height=Math.abs(i)+"px",B.style.top=G.y+"px",B.style.left=G.x+"px",Array.from(_).forEach(n=>{Me(n,B)&&e.ctrlKey&&ae.includes(n)?n.firstElementChild.checked=!1:Me(n,B)||e.ctrlKey&&ae.includes(n)||e.shiftKey&&ae.includes(n)?n.firstElementChild.checked||(n.firstElementChild.checked=!0):n.firstElementChild.checked=!1}))}}function Te(){B&&B.remove(),G=void 0,ye=!1,C&&C.remove()}function Me(e,t){const i=e.getBoundingClientRect(),n=t.getBoundingClientRect();return i.left<n.left+n.width&&i.left+i.width>n.left&&i.top<n.top+n.height&&i.top+i.height>n.top}function je(){for(const e of _)e.onclick=function(t){t.preventDefault();const i=this;let n=D("start"),s=D("last"),o=D();if(!t.ctrlKey&&!t.shiftKey)o.length&&o.forEach(a=>{a!==this&&(a.firstElementChild.checked=!1)}),this.firstElementChild.checked=!0;else if(t.ctrlKey)this.firstElementChild.checked?this.firstElementChild.checked=!1:this.firstElementChild.checked=!0;else if(t.shiftKey)if(o.length){let a=null;for(let r=n.index;r<=s.index;r++)if(!o[r]){a=r-1;break}if(i.index>=s.index&&!a){let r=s.index+1;for(;r<=i.index;)_[r].firstElementChild.checked=!0,r++}else if(i.index>=s.index&&a){let r=a+1;for(;r<=i.index;)_[r].firstElementChild.checked=!0,r++}else if(i.index<=s.index&&i.index>=n.index&&!a)for(let r=n.index;r<=s.index;r++)o[r].firstElementChild.checked=r<=i.index;else if(i.index<=s.index&&i.index>=n.index&&a)for(let r=n.index;r<=s.index;r++)o[r]&&(o[r].firstElementChild.checked=r<=i.index);else if(i.index<n.index){let r=i.index;for(;r<=n.index;)_[r].firstElementChild.checked=!0,r++}}else Array.from(_).filter((a,r)=>r<=i.index).forEach(a=>a.firstElementChild.checked=!0);window.dispatchEvent(We)}}function D(e=void 0){const t=[];let i=null,n=null,s=0;for(const a of _)a.firstElementChild.checked&&(i===null&&(i=s),n=s,t[s]=a),s++;let o;switch(e){case"start":return o={index:i,item:t[i]},o;case"last":return o={index:n,item:t[n]},o;default:return t}}function _e(){C&&(C.width=F.clientWidth,C.height=F.clientHeight),_=x.querySelectorAll(".item"),je(),ve()}function Ge(){F.addEventListener("mousedown",He),document.addEventListener("mousemove",Se),document.addEventListener("mouseup",Te),F.addEventListener("touchstart",He),document.addEventListener("touchmove",Se),document.addEventListener("touchend",Te),document.addEventListener("mousedown",function(e){!e.target.closest(".item")&&!e.ctrlKey&&!e.shiftKey&&D().forEach(t=>t.firstElementChild.checked=!1)}),window.addEventListener("refresh-event",_e),window.addEventListener("show-info-file",function(){let e=D("last");if(e.index===null||e.index===void 0)return Z.innerHTML='<p class="text-center">Chọn tệp để xem thông tin</p>',!1;let t=JSON.parse(e.item.dataset.file),i=t.customs?JSON.parse(t.customs):[];if(Object.keys(i).length===0)return Z.innerHTML='<p class="text-center">Chọn tệp để xem thông tin</p>',!1;let n={};const s=document.createElement("img"),o=document.createElement("table"),a=document.createElement("tbody");let r=document.createElement("tr");Z.innerHTML="",Z.innerHTML=`<h1>Thông tin</h1>
                            <div class="image"></div>
                            <div class="info-body"></div>`;const m=Z.querySelector(".image"),u=Z.querySelector(".info-body");o.append(a),u.append(o),a.append(r);let w=!1;i.extension&&i.pathAbsolute&&(["png","gif","jpg","webp","jpeg","svg"].includes(i.extension)?(s.src=`/${i.pathAbsolute}`,w=!0):["docx","mp4","pdf","xlsx","pptx"].includes(i.extension)?s.src=`/images/admin/${i.extension}.svg`:s.src="/images/admin/file.svg",s.src&&m.append(s)),s.src?s.onload=b=>f(b,w):f();function f(b,p=!1){n.filename=i.filename,n.extension=i.extension,n.size=De(i.size),p&&(n.natural=`${s.naturalWidth} ✕ ${s.naturalHeight}`),n.created_at=i.created_at;for(const[l,c]of Object.entries(n))if(c){if(r.children.length>=2){let d=document.createElement("tr");a.append(d),r=d}switch(l){case"filename":r.insertAdjacentHTML("beforeend",`<td>
                            <div class="title">Tên tệp tin</div>
                            <div class="info">${c}</div>
                        </td>`);break;case"extension":r.insertAdjacentHTML("beforeend",`<td>
                            <div class="title">Định dạng</div>
                            <div class="info">${c}</div>
                        </td>`);break;case"size":r.insertAdjacentHTML("beforeend",`<td>
                            <div class="title">Dung lượng</div>
                            <div class="info">${c}</div>
                        </td>`);break;case"natural":r.insertAdjacentHTML("beforeend",`<td>
                            <div class="title">Kích thước</div>
                            <div class="info">${c}</div>
                        </td>`);break;case"created_at":const d=new Date(c),h=d.getDate(),y=d.getMonth(),E=d.getFullYear();r.insertAdjacentHTML("beforeend",`<td>
                            <div class="title">Ngày tải lên</div>
                            <div class="info">${h} tháng ${y} ${E}</div>
                        </td>`);break}}}}),je()}const le=new Event("refresh-event"),oe=new Event("choose-image"),Ae=document.querySelector(".add-folder"),ke=document.querySelector(".upload-file");let N=new DataTransfer;const Qe=new Event("add-folder"),Ze=new Event("add-file"),re=new Event("load-item");let R,K,ce;window.addEventListener("add-folder",e=>{R=document.createElement("form"),R.classList.add("form-add-folder");const t=document.createElement("div");t.classList.add("form-container");const i=document.createElement("input");i.placeholder="Nhập tên thư mục...";const n=document.createElement("button");t.append(i,n),R.append(t);const s=window.location.pathname.replace("/admin/medias","");n.innerText="Thêm thư mục",R.onsubmit=async o=>{n.setAttribute("disabled",!0),o.preventDefault(),k.setEndpoint(Be+"/admin");const a=await k.post("/medias/add/folder",{folderName:i.value,media_id:s});if(a.data.status==="NOT OK")g.error(a.data.errors[0].folderName);else{W.querySelector("a")||(W.innerHTML=""),z.querySelector("li")||(z.innerHTML="");let r=z.querySelector(`[href="/admin/medias/${s.startsWith("/")?s.slice(1):s}"]`);if(!r)z.insertAdjacentHTML("beforeend",j.itemFolderAside(a.data.folder));else if(r.nextElementSibling)r.nextElementSibling.insertAdjacentHTML("beforeend",j.itemFolderAside(a.data.folder));else{const m=document.createElementNS("http://www.w3.org/2000/svg","svg");m.setAttributeNS(null,"viewBox","0 0 320 512"),m.innerHTML='<path d="M137.4 374.6c12.5 12.5 32.8 12.5 45.3 0l128-128c9.2-9.2 11.9-22.9 6.9-34.9s-16.6-19.8-29.6-19.8L32 192c-12.9 0-24.6 7.8-29.6 19.8s-2.2 25.7 6.9 34.9l128 128z"></path>',r.prepend(m),r.insertAdjacentHTML("afterend",`<ul>${j.itemFolderAside(a.data.folder)}</ul>`)}window.dispatchEvent(qe),W.insertAdjacentHTML("beforeend",j.itemFolder(a.data.folder)),g.success(a.data.message),R.remove(),window.dispatchEvent(Ye)}},R.onclick=o=>{o.target===R&&R.remove()},document.body.append(R)});window.addEventListener("add-file",e=>{K=document.createElement("form"),K.classList.add("form-add-file"),K.onclick=s=>{s.target===K&&Ie()};const{divContainer:t,input:i,button:n}=et();K.append(t),K.onsubmit=async s=>{s.preventDefault(),n.setAttribute("disabled",!0),S.setEndpoint(Be+"/admin");const o=window.location.pathname.replace("/admin/medias","");S.setType("formData");const a=await S.post("/medias/add/file",{files:Array.from(i.files),media_id:o});a.status===200?(x.querySelector(".item")||(x.innerHTML=""),re.items=a.successFiles,window.dispatchEvent(re),g.success(a.message),Ie(),window.dispatchEvent(le)):(g.error(a.message),n.removeAttribute("disabled"))},document.body.append(K)});function et(){let e=null,t=document.createElement("div");const i=document.createElement("div"),n=document.createElement("input"),s=document.createElement("button"),o=document.createElement("div"),a=document.createElement("span"),r=document.createTextNode(0),m=document.createTextNode("");a.style.color="white",a.innerText="Đã chọn (",m.data=")",a.append(r,m),o.className="items",t.className="upload-place",i.classList.add("form-container"),n.type="file",n.setAttribute("hidden",""),n.setAttribute("multiple",""),s.innerText="Thêm file",s.className="btn-submit",t.append(o),i.append(a,s,t,n),u(),t.ondragover=l=>{l.preventDefault()};function u(){t.onclick=l=>{(l.target===t||l.target===o)&&n.click()},n.onchange=l=>{const c=l.target.files;let d=N.files;const h=N.items;if(d.length===0){for(const y of c)h.add(y);f(w())}else{const y=Array.from(c).filter(E=>Array.from(d).some(L=>b(L,E))?!1:(h.add(E),!0));y.length&&f(y)}w()}}function w(){return n.files=N.files,r.data=N.files.length,N.files}function f(l){ce=Array.from(l).map((c,d)=>{const h=c.name,y=h.slice(h.lastIndexOf(".")+1),E=URL.createObjectURL(c),L=document.createElement("div"),Q=document.createElement("span"),I=document.createElement("img"),P=document.createElement("button");return Q.innerText=h,L.className="item",["png","jpeg","jpg","webp","tiff","svg","bmp"].includes(y.toLowerCase())?I.src=E:["docx","pptx","xlsx","pdf","mp4"].includes(y.toLowerCase())?I.src=`/images/admin/${y.toLowerCase()}.svg`:I.src="/images/admin/file.svg",P.type="button",P.innerHTML="&times;",L.setAttribute("data-info",JSON.stringify({name:c.name,type:c.type,size:c.size})),L.append(I,P,Q),{itemEl:L,url:E,button:P,name:c.name,type:c.type,size:c.size}}),o.append(...ce.map(c=>c.itemEl)),o.ondragover=c=>{c.preventDefault()},ce.forEach(c=>{c.button.onclick=d=>{d.preventDefault();const h=Array.from(N.files).findIndex(y=>b(y,c));N.items.remove(h),c.itemEl.remove(),URL.revokeObjectURL(c.url),w()},c.itemEl.draggable=!0,c.itemEl.ondragstart=d=>{e=c.itemEl},c.itemEl.ondragover=d=>{d.preventDefault();const h=d.target.closest(".item");if(h){const y=h.offsetWidth/2;d.offsetX>y?h.parentElement.insertBefore(h,e):d.offsetX<=y&&h.parentElement.insertBefore(e,h)}},c.itemEl.ondrop=()=>{e=null,p()}})}function b(l,c){return l.name===c.name&&l.size===c.size&&l.type===c.type}function p(){const l=new DataTransfer,c=o.children;for(const d of c){const h=Array.from(N.files).findIndex(y=>b(y,JSON.parse(d.dataset.info)));h!==-1&&l.items.add(N.files[h])}N=l,w()}return{divContainer:i,input:n,button:s}}function Ie(){K.remove(),N=new DataTransfer;for(const{url:e}of ce)URL.revokeObjectURL(e)}window.addEventListener("load-item",e=>{e.items&&Array.isArray(e.items)&&e.items.forEach(t=>{x.insertAdjacentHTML("afterbegin",j.itemFile(t))})});function tt(){Ae&&(Ae.onclick=e=>{window.dispatchEvent(Qe)}),ke&&(ke.onclick=e=>{window.dispatchEvent(Ze)})}function nt(){let e=new URLSearchParams(window.location.search).get("page")??1,t=!1,i=new IntersectionObserver(n);async function n(o){for(const a of o)if(a.isIntersecting&&!t){e++,t=!0;const{pathname:r}=window.location;k.setParam("page",e),k.setParam("isJson",1),i.disconnect();try{const m=await k.get(r);m.data&&m.data.rows&&m.data.rows.length&&(re.items=m.data.rows,window.dispatchEvent(re),s=x.children[x.children.length-1],i.observe(s),t=!1,window.dispatchEvent(le),window.dispatchEvent(Ue))}catch(m){console.log(m.message)}}}let s=x.children[x.children.length-1];s&&i.observe(s)}const st=(()=>{function e(){const s=document.querySelector(".events .delete");s&&s.addEventListener("click",async o=>{if(confirm("Bạn có muốn xóa các tệp tin đã chọn?")){let a=D(),r=a.map(u=>JSON.parse(u.dataset.file).id);s.setAttribute("disabled",!0);const m=await S.post("/admin/medias/delete-all",{ids:r});m.status===200?(g.success(m.message),a.forEach(u=>u.remove())):g.error(m.message),s.removeAttribute("disabled")}}),s&&s.addEventListener("mousedown",o=>{o.stopPropagation()})}function t(){const s=document.querySelector(".events .restore");s&&s.addEventListener("click",async o=>{if(confirm("Bạn có muốn khôi phục các tệp tin đã chọn?")){let a=D(),r=a.map(u=>JSON.parse(u.dataset.file).id);s.setAttribute("disabled",!0);const m=await S.post("/admin/medias/restore-all",{ids:r});m.status===200?(g.success(m.message),a.forEach(u=>u.remove())):g.error(m.message),s.removeAttribute("disabled")}}),s&&s.addEventListener("mousedown",o=>{o.stopPropagation()})}function i(){const s=document.querySelector(".events .delete-force");s&&s.addEventListener("click",async o=>{if(confirm("Bạn có chắc muốn xóa tệp tin này? Chúng sẽ không còn xuất hiện trên blog của bạn, bao gồm bài viết, trang, và widget. Hành động này không thể phục hồi?")){let a=D(),r=a.map(u=>JSON.parse(u.dataset.file).id);s.setAttribute("disabled",!0);const m=await S.post("/admin/medias/delete-force",{ids:r});m.status===200?(g.success(m.message),a.forEach(u=>u.remove())):g.error(m.message),s.removeAttribute("disabled")}}),s&&s.addEventListener("mousedown",o=>{o.stopPropagation()})}function n(){const s=document.querySelector(".events .choose-file");s&&(s.addEventListener("click",function(o){const a=window.frameElement;if(!a)return!1;const r=a.dataset.uuid,m=a.dataset.type,u=D(m);if(!u.item)return g.error("Vui lòng chọn tệp tin");oe.uuid=r,oe.data=u.item.dataset.file,oe.typeImage=m,window.parent.dispatchEvent(oe)}),s.addEventListener("mousedown",function(o){o.stopPropagation()}))}return{init:()=>{e(),t(),i(),n()}}})();window.addEventListener("DOMContentLoaded",function(){st.init(),Ge(),tt(),nt(),Ke(),Pe()});
